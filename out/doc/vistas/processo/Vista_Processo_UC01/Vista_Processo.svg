<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="613px" preserveAspectRatio="none" style="width:1300px;height:613px;background:#FFFFFF;" version="1.1" viewBox="0 0 1300 613" width="1300px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="522.8906" style="stroke:#181818;stroke-width:1.0;" width="10" x="24.5" y="46.2969"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="309.5" y="67.4297"/><rect fill="#FFFFFF" height="190.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="381.5" y="226.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="565.5" y="167.8594"/><rect fill="#FFFFFF" height="59.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="565.5" y="328.5234"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="565.5" y="445.9219"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="920.5" y="357.6563"/><rect height="59.2656" style="stroke:#000000;stroke-width:1.5;fill:none;" width="226" x="344.5" y="241.125"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="29" x2="29" y1="36.2969" y2="578.1875"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="314.5" x2="314.5" y1="36.2969" y2="578.1875"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="386.5" x2="386.5" y1="136.0781" y2="578.1875"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="570" x2="570" y1="36.2969" y2="578.1875"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="925.5" x2="925.5" y1="36.2969" y2="578.1875"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1152.5" x2="1152.5" y1="36.2969" y2="578.1875"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="49" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="12" y="24.9951">main</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="49" x="5" y="577.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="12" y="597.1826">main</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44" x="292.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="299.5" y="24.9951">utils</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44" x="292.5" y="577.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="299.5" y="597.1826">utils</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="354.5" y="577.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="361.5" y="597.1826">Thread</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="45" x="548" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="555" y="24.9951">cmd</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="45" x="548" y="577.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="555" y="597.1826">cmd</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="849.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="856.5" y="24.9951">Intel Power Gadget</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="849.5" y="577.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="856.5" y="597.1826">Intel Power Gadget</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="283" x="1011.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="269" x="1018.5" y="24.9951">Nvidia System Management Interface</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="283" x="1011.5" y="577.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="269" x="1018.5" y="597.1826">Nvidia System Management Interface</text><rect fill="#FFFFFF" height="522.8906" style="stroke:#181818;stroke-width:1.0;" width="10" x="24.5" y="46.2969"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="309.5" y="67.4297"/><rect fill="#FFFFFF" height="190.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="381.5" y="226.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="565.5" y="167.8594"/><rect fill="#FFFFFF" height="59.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="565.5" y="328.5234"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="565.5" y="445.9219"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="920.5" y="357.6563"/><polygon fill="#181818" points="297.5,63.4297,307.5,67.4297,297.5,71.4297,301.5,67.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="34.5" x2="303.5" y1="67.4297" y2="67.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="41.5" y="62.3638">initialize_files()</text><polygon fill="#181818" points="342.5,122.5625,352.5,126.5625,342.5,130.5625,346.5,126.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="34.5" x2="348.5" y1="126.5625" y2="126.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="296" x="41.5" y="121.4966">create(target = process_cpu_usage, args = 0)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="354.5" y="105.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="361.5" y="125.4248">Thread</text><polygon fill="#181818" points="553.5,163.8594,563.5,167.8594,553.5,171.8594,557.5,167.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="34.5" x2="559.5" y1="167.8594" y2="167.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257" x="41.5" y="162.7935">pid = get_gpu_report(filename, interval)</text><polygon fill="#181818" points="1141,192.9922,1151,196.9922,1141,200.9922,1145,196.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="570.5" x2="1147" y1="196.9922" y2="196.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="500" x="577.5" y="191.9263">nvidia-smi --query-gpu=timestamp,power.draw -lms interval &gt;&gt; filename.csv</text><polygon fill="#181818" points="369.5,222.125,379.5,226.125,369.5,230.125,373.5,226.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="34.5" x2="375.5" y1="226.125" y2="226.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="41.5" y="221.0591">start()</text><path d="M344.5,241.125 L422.5,241.125 L422.5,248.2578 L412.5,258.2578 L344.5,258.2578 L344.5,241.125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="59.2656" style="stroke:#000000;stroke-width:1.5;" width="226" x="344.5" y="241.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="359.5" y="254.1919">loop</text><line style="stroke:#181818;stroke-width:1.0;" x1="391.5" x2="433.5" y1="279.3906" y2="279.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="433.5" x2="433.5" y1="279.3906" y2="292.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="392.5" x2="433.5" y1="292.3906" y2="292.3906"/><polygon fill="#181818" points="402.5,288.3906,392.5,292.3906,402.5,296.3906,398.5,292.3906" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="398.5" y="274.3247">get_cpu_percentage(pid)</text><polygon fill="#181818" points="553.5,324.5234,563.5,328.5234,553.5,332.5234,557.5,328.5234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="34.5" x2="559.5" y1="328.5234" y2="328.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308" x="41.5" y="323.4575">get_process_report(save_file_name, command)</text><polygon fill="#181818" points="908.5,353.6563,918.5,357.6563,908.5,361.6563,912.5,357.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="575.5" x2="914.5" y1="357.6563" y2="357.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="326" x="582.5" y="352.5903">powerlog.exe -file save_file_name -cmd command</text><polygon fill="#181818" points="374.5,412.7891,384.5,416.7891,374.5,420.7891,378.5,416.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="34.5" x2="380.5" y1="416.7891" y2="416.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="41.5" y="411.7231">join()</text><polygon fill="#181818" points="553.5,441.9219,563.5,445.9219,553.5,449.9219,557.5,445.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="34.5" x2="559.5" y1="445.9219" y2="445.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="41.5" y="440.856">kill_process(pid)</text><line style="stroke:#181818;stroke-width:1.0;" x1="34.5" x2="76.5" y1="505.0547" y2="505.0547"/><line style="stroke:#181818;stroke-width:1.0;" x1="76.5" x2="76.5" y1="505.0547" y2="518.0547"/><line style="stroke:#181818;stroke-width:1.0;" x1="35.5" x2="76.5" y1="518.0547" y2="518.0547"/><polygon fill="#181818" points="45.5,514.0547,35.5,518.0547,45.5,522.0547,41.5,518.0547" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261" x="41.5" y="499.9888">estimate_process_power_consumption()</text><line style="stroke:#181818;stroke-width:1.0;" x1="34.5" x2="76.5" y1="547.1875" y2="547.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="76.5" x2="76.5" y1="547.1875" y2="560.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="35.5" x2="76.5" y1="560.1875" y2="560.1875"/><polygon fill="#181818" points="45.5,556.1875,35.5,560.1875,45.5,564.1875,41.5,560.1875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="41.5" y="542.1216">save_results()</text><!--MD5=[1bef09e087be076e6deac5833d2a34ca]
@startuml
participant "main" as MAIN
participant "utils" as UTILS
participant "Thread" as THRD
participant "cmd" as CMD
participant "Intel Power Gadget" as IPG
participant "Nvidia System Management Interface" as SMI

activate MAIN
MAIN -> UTILS: initialize_files()
activate UTILS
deactivate UTILS

MAIN -> THRD**: create(target = process_cpu_usage, args = 0)

MAIN-> CMD: pid = get_gpu_report(filename, interval)
activate CMD
CMD -> SMI : nvidia-smi - -query-gpu=timestamp,power.draw -lms interval >> filename.csv
deactivate

MAIN -> THRD: start()
activate THRD
loop 
THRD -> THRD: get_cpu_percentage(pid)
end loop 

MAIN -> CMD: get_process_report(save_file_name, command)
activate CMD
CMD -> IPG: powerlog.exe -file save_file_name -cmd command
activate IPG
deactivate IPG
deactivate CMD

MAIN -> THRD : join()
deactivate THRD

MAIN -> CMD: kill_process(pid)
activate CMD
deactivate


MAIN -> MAIN: estimate_process_power_consumption()

MAIN -> MAIN: save_results()
@enduml

PlantUML version 1.2022.6beta5(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>